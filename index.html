<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- PWA MANIFEST -->
    <link rel="manifest" href="manifest.json">
    
    <!-- For iOS - Add to Home Screen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Dr. William">
    <link rel="apple-touch-icon" href="images/icon-192.png">
    
    <!-- Theme color -->
    <meta name="theme-color" content="#D4AF37">
    
    <title>Kilinge cha Dr. William</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --gold-primary: #D4AF37;
            --gold-shine: #FFD700;
            --gold-dark: #AA6C39;
            --dark-bg: #050505;
            --panel-black: rgba(10, 10, 10, 0.85);
            --text-white: #F5F5F5;
            --text-gold: #F4E4BC;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--dark-bg);
            background-image: linear-gradient(rgba(0,0,0,0.85), rgba(0,0,0,0.7)),
                url('https://images.unsplash.com/photo-1517816428104-797678c7cf0c?auto=format&fit=crop&w=1500&q=80');
            background-size: cover;
            background-attachment: fixed;
            background-position: center 0;
            color: var(--text-white);
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-position 0.1s ease-out;
        }

        /* Parallax background */
        body::after {
            content: '';
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: inherit;
            background-attachment: scroll;
            background-position: center 0;
            z-index: -1;
            animation: slowZoom 30s infinite alternate ease-in-out;
        }
        @keyframes slowZoom {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }

        /* ===== KITUFE CHA KUSAKINISHA - DUARA ===== */
        .install-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 10001;
            animation: fadeOut 5s forwards;
            animation-delay: 3s;
        }

        #install-button {
            background: linear-gradient(135deg, #D4AF37, #AA6C39);
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 25px rgba(212,175,55,0.7);
            transition: transform 0.3s, box-shadow 0.3s, opacity 0.5s;
            font-family: 'Cinzel', serif;
            position: relative;
        }

        #install-button i { 
            font-size: 1.8rem;
            margin: 0;
        }

        #install-button:hover {
            transform: scale(1.1);
            box-shadow: 0 0 40px var(--gold-shine);
        }

        @keyframes fadeOut {
            0% { opacity: 1; transform: scale(1); }
            70% { opacity: 0.7; transform: scale(0.9); }
            100% { opacity: 0; transform: scale(0); display: none; visibility: hidden; }
        }

        #install-button::after {
            content: "Sakinisha App BURE";
            position: absolute;
            right: 70px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            white-space: nowrap;
            border: 1px solid var(--gold-primary);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        #install-button:hover::after {
            opacity: 1;
        }

        @media (max-width:768px) {
            .install-container {
                bottom: 80px;
                right: 15px;
            }
            
            #install-button {
                width: 50px;
                height: 50px;
            }
            
            #install-button i { 
                font-size: 1.5rem;
            }
            
            #install-button::after {
                right: 60px;
                font-size: 12px;
                padding: 5px 10px;
            }
        }

        /* ===== SHAKE ANIMATION ===== */
        @keyframes shake {
            0%,100% { transform: translateX(0); }
            10%,30%,50%,70%,90% { transform: translateX(-5px); }
            20%,40%,60%,80% { transform: translateX(5px); }
        }
        .shake { animation: shake 0.5s ease-in-out; }

        /* ===== TIMER DISPLAY ===== */
        #timer-display {
            position: fixed;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #D4AF37, #AA6C39);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: bold;
            z-index: 9999;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border: 2px solid #FFD700;
            cursor: pointer;
            font-family: 'Cinzel', serif;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        /* ===== CODE OVERLAY ===== */
        #code-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            backdrop-filter: blur(8px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            flex-direction: column;
            padding: 20px;
        }
        .code-box {
            background: var(--panel-black);
            border: 2px solid var(--gold-dark);
            border-radius: 20px;
            padding: 40px 30px;
            max-width: 450px;
            width: 100%;
            text-align: center;
            box-shadow: 0 0 50px rgba(212,175,55,0.3);
            position: relative;
            overflow: hidden;
        }
        .code-box::before {
            content: '';
            position: absolute;
            top: -2px; left: -2px; right: -2px; height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold-shine), transparent);
            animation: scan 3s linear infinite;
        }
        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .code-box h2 {
            color: var(--gold-shine);
            font-family: 'Cinzel', serif;
            margin-bottom: 10px;
            font-size: 1.5rem;
        }
        .code-box p {
            color: #ccc;
            margin-bottom: 30px;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        .code-input {
            width: 100%;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border: 1px solid var(--gold-dark);
            border-radius: 8px;
            color: white;
            font-size: 1.2rem;
            text-align: center;
            letter-spacing: 2px;
            margin-bottom: 20px;
            transition: 0.3s;
        }
        .code-input:focus {
            outline: none;
            border-color: var(--gold-primary);
            box-shadow: 0 0 15px rgba(212,175,55,0.3);
        }
        .btn-code {
            background: linear-gradient(135deg, #8B6914, #D4AF37);
            border: none; color: #000; font-weight: bold; padding: 15px; width: 100%;
            border-radius: 8px; font-size: 1.2rem; cursor: pointer; transition: 0.3s;
            font-family: 'Cinzel', serif; letter-spacing: 2px; margin-bottom: 20px;
        }
        .btn-code:hover {
            transform: scale(1.02);
            box-shadow: 0 0 20px var(--gold-dark);
        }
        .whatsapp-code-btn {
            background: #25D366; color: white; border: none; padding: 12px; width: 100%;
            border-radius: 8px; font-size: 1.1rem; cursor: pointer; transition: 0.3s;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .whatsapp-code-btn:hover {
            background: #128C7E; transform: scale(1.02);
        }
        .error-message {
            color: #ff6b6b; margin-top: 10px; font-size: 0.9rem; min-height: 20px;
        }

        /* ===== VIBOX 4 (kwenye login page) ===== */
        .external-boxes-login {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        .external-box-login {
            width: 70px;
            height: 70px;
            background: rgba(0,0,0,0.8);
            border: 2px solid var(--gold-primary);
            border-radius: 15px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.7rem;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        .external-box-login .box-image {
            width: 100%;
            height: 40px;
            background-size: cover;
            background-position: center;
            border-bottom: 1px solid var(--gold-dark);
        }
        .external-box-login .box-title {
            background: rgba(0,0,0,0.8);
            width: 100%;
            padding: 5px 0;
            font-family: 'Cinzel', serif;
            font-size: 0.7rem;
            color: var(--gold-primary);
            font-weight: bold;
        }

        /* ===== MAIN CONTENT ===== */
        #main-content { display: none; position: relative; z-index: 1; }

        /* ===== INTRO ANIMATION ===== */
        #intro-overlay {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: #000; z-index: 9999; display: none;
            flex-direction: column; justify-content: center; align-items: center;
        }
        .mystic-circle {
            width:150px; height:150px;
            border:2px solid transparent; border-top:2px solid var(--gold-primary); border-bottom:2px solid var(--gold-primary);
            border-radius:50%; animation:spin 2s linear infinite; position:relative;
            box-shadow:0 0 20px var(--gold-dark);
        }
        .mystic-circle::before {
            content:''; position:absolute; top:10px; left:10px; right:10px; bottom:10px;
            border:2px solid transparent; border-left:2px solid var(--gold-shine); border-right:2px solid var(--gold-shine);
            border-radius:50%; animation:spinReverse 3s linear infinite;
        }
        .intro-text {
            margin-top:30px; font-family:'Cinzel',serif; font-size:1.5rem; color:var(--gold-shine);
            letter-spacing:3px; animation:pulseText 2s infinite; text-align:center;
        }
        @keyframes spin { 0%{transform:rotate(0);}100%{transform:rotate(360deg);} }
        @keyframes spinReverse { 0%{transform:rotate(360deg);}100%{transform:rotate(0);} }
        @keyframes pulseText { 0%,100%{opacity:0.5;}50%{opacity:1;text-shadow:0 0 10px var(--gold-primary);} }

        /* ===== HEADER ===== */
        header {
            text-align:center; padding:40px 20px;
            border-bottom:1px solid rgba(212,175,55,0.3);
            background:linear-gradient(to bottom, rgba(0,0,0,0.9), transparent);
        }
        .dr-title {
            font-family:'Cinzel',serif; font-size:2.8rem;
            background:linear-gradient(to right, #BF953F, #FCF6BA, #B38728, #FBF5B7, #AA771C);
            -webkit-background-clip:text; color:transparent; margin:0;
            text-shadow:0 0 20px rgba(0,0,0,0.8); font-weight:900; letter-spacing:2px;
        }
        .subtitle {
            font-family:'Playfair Display',serif; color:var(--text-gold); font-style:italic;
            letter-spacing:1px; margin-top:5px;
        }

        /* ===== SERVICE MENU ===== */
        .service-menu {
            display:flex; justify-content:center; gap:15px; flex-wrap:wrap; margin:30px auto; padding:0 15px;
        }
        .btn-service {
            background:rgba(0,0,0,0.5); border:1px solid var(--gold-dark); color:var(--text-gold);
            padding:12px 25px; border-radius:50px; cursor:pointer; font-family:'Cinzel',serif; font-weight:bold;
            transition:all 0.4s ease; text-transform:uppercase; letter-spacing:1px; backdrop-filter:blur(5px);
        }
        .btn-service:hover, .btn-service.active {
            background:var(--gold-primary); color:#000; box-shadow:0 0 15px var(--gold-dark); transform:translateY(-3px);
        }

        /* ===== CONTAINERS ===== */
        .container {
            width:95%; max-width:650px; margin:20px auto 60px; background:var(--panel-black);
            padding:40px; border-radius:10px; border:1px solid var(--gold-dark);
            box-shadow:0 20px 50px rgba(0,0,0,0.7); position:relative; overflow:hidden;
        }
        .container::before {
            content:''; position:absolute; top:0; left:0; width:100%; height:3px;
            background:linear-gradient(90deg, transparent, var(--gold-shine), transparent);
        }
        h2 {
            color:var(--gold-shine); text-align:center; font-family:'Cinzel',serif;
            border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:15px; margin-bottom:25px;
        }
        label {
            display:block; margin-top:20px; color:var(--gold-primary); font-weight:600;
            font-size:0.9rem; text-transform:uppercase; letter-spacing:1px;
        }
        input, select, textarea {
            width:100%; padding:15px; margin-top:10px; border-radius:5px; border:1px solid #333;
            background:rgba(255,255,255,0.05); color:#fff; font-family:'Poppins',sans-serif; font-size:1rem; transition:0.3s;
        }
        input:focus, select:focus, textarea:focus {
            outline:none; border-color:var(--gold-primary); background:rgba(0,0,0,0.8);
            box-shadow:0 0 10px rgba(212,175,55,0.2);
        }
        .btn-magic {
            background:linear-gradient(135deg, #8B6914, #D4AF37, #8B6914); background-size:200% auto;
            color:#fff; padding:18px; border:none; border-radius:5px; font-weight:900; font-family:'Cinzel',serif;
            text-transform:uppercase; letter-spacing:2px; cursor:pointer; width:100%; margin-top:30px;
            transition:0.5s; box-shadow:0 5px 15px rgba(0,0,0,0.5);
        }
        .btn-magic:hover {
            background-position:right center; box-shadow:0 0 25px var(--gold-dark); transform:scale(1.02);
        }

        /* ===== NEXT PAGE BUTTON ===== */
        .btn-next-page {
            background:linear-gradient(45deg, #800000, #b30000);
            border:2px solid var(--gold-shine); color:white; padding:20px; display:block; text-align:center;
            text-decoration:none; font-family:'Cinzel',serif; font-size:1.2rem; font-weight:bold;
            border-radius:8px; margin-top:20px; animation:pulseBtn 2s infinite; position:relative; overflow:hidden;
        }
        .btn-next-page::after {
            content:''; position:absolute; top:-50%; left:-50%; width:200%; height:200%;
            background:linear-gradient(transparent, rgba(255,255,255,0.3), transparent);
            transform:rotate(45deg); animation:shine 3s infinite;
        }
        .btn-next-page:hover {
            background:linear-gradient(45deg, #b30000, #ff0000);
            box-shadow:0 0 30px rgba(255,0,0,0.6); transform:scale(1.05);
        }
        @keyframes pulseBtn {
            0%{box-shadow:0 0 0 0 rgba(255,215,0,0.4);}
            70%{box-shadow:0 0 0 15px rgba(255,215,0,0);}
            100%{box-shadow:0 0 0 0 rgba(255,215,0,0);}
        }
        @keyframes shine { 0%{left:-100%;}100%{left:100%;} }

        /* ===== CARDS ===== */
        #cards-container {
            display:none; gap:25px; flex-wrap:wrap; justify-content:center; padding:20px; max-width:1200px; margin:0 auto;
        }
        .card {
            width:300px; height:450px; perspective:1500px; cursor:pointer; transition:all 0.3s;
        }
        .card.expanded {
            width:90%; max-width:600px; height:80vh; z-index:1000; position:fixed; top:50%; left:50%;
            transform:translate(-50%, -50%);
        }
        .card-inner {
            position:relative; width:100%; height:100%; transition:transform 0.8s; transform-style:preserve-3d;
            box-shadow:0 10px 30px rgba(0,0,0,0.8); border-radius:15px;
        }
        .card.flipped .card-inner { transform:rotateY(180deg); }
        .card-back {
            position:absolute; width:100%; height:100%; backface-visibility:hidden; border-radius:15px;
            background-size:cover; background-position:center; display:flex; flex-direction:column;
            justify-content:flex-end; border:2px solid var(--gold-dark);
        }
        .card-back::before {
            content:''; position:absolute; top:0; left:0; width:100%; height:100%;
            background:linear-gradient(to top, rgba(0,0,0,1), rgba(0,0,0,0.3));
        }
        .card-back-content {
            position:relative; z-index:2; padding:20px; text-align:center;
        }
        .card-title-back {
            font-family:'Cinzel',serif; color:var(--gold-shine); font-size:1.4rem; font-weight:bold;
            text-shadow:0 2px 5px rgba(0,0,0,1);
        }
        .card-hint { font-size:0.8rem; color:#ccc; }
        .card-front {
            position:absolute; width:100%; height:100%; backface-visibility:hidden; border-radius:15px;
            background:#111; transform:rotateY(180deg); overflow-y:auto; border:2px solid var(--gold-shine);
            display:flex; flex-direction:column;
        }
        .card-header-img {
            height:150px; width:100%; object-fit:cover; border-bottom:2px solid var(--gold-primary);
        }
        .card-body { padding:20px; }
        .card-body h3 {
            color:var(--gold-shine); font-family:'Cinzel',serif; border-bottom:1px solid #333;
            padding-bottom:10px; margin-top:0;
        }
        .good-traits, .bad-traits {
            margin: 10px 0;
        }
        .good-traits span, .bad-traits span {
            display: inline-block; margin: 3px; padding:4px 10px; border-radius:20px; font-size:0.8rem;
        }
        .good-traits span { background:rgba(46, 125, 50, 0.3); border:1px solid #2e7d32; }
        .bad-traits span { background:rgba(211, 47, 47, 0.3); border:1px solid #d32f2f; }
        .job-item {
            display:flex; align-items:center; background:rgba(255,255,255,0.05); margin-bottom:10px;
            padding:10px; border-radius:8px; border-left:3px solid var(--gold-dark);
        }
        .job-item img {
            width:50px; height:50px; border-radius:50%; margin-right:15px; object-fit:cover;
            border:1px solid var(--gold-shine);
        }
        .close-card {
            position:absolute; top:10px; right:10px; background:rgba(0,0,0,0.7); color:white;
            width:30px; height:30px; border-radius:50%; text-align:center; line-height:30px;
            cursor:pointer; z-index:10; border:1px solid white; font-weight:bold;
        }

        /* ===== WHATSAPP FLOAT ===== */
        .whatsapp-float {
            position:fixed; bottom:20px; right:20px; background:#25D366; color:white; width:60px; height:60px;
            border-radius:50%; display:flex; justify-content:center; align-items:center; font-size:30px;
            box-shadow:0 5px 20px rgba(0,0,0,0.5); cursor:pointer; z-index:1000; transition:transform 0.3s;
        }
        .whatsapp-float:hover { transform:scale(1.1); }
        .send-btn {
            background:linear-gradient(45deg, #11998e, #38ef7d); color:white; padding:15px; border:none;
            border-radius:50px; font-weight:bold; width:100%; font-size:1.1rem; cursor:pointer;
            box-shadow:0 0 20px rgba(56,239,125,0.3);
        }

        /* ===== HUDUMA ===== */
        .services-container {
            margin-top:100px; margin-bottom:50px; padding:20px; text-align:center; position:relative; z-index:1;
        }
        .section-title {
            color:#D4AF37; font-family:'Cinzel',serif; font-size:2rem; margin-bottom:40px;
            letter-spacing:2px; text-shadow:0 0 10px rgba(212,175,55,0.5);
        }
        .services-grid {
            display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:25px;
            max-width:1000px; margin:0 auto;
        }
        .service-box {
            position:relative; height:250px; border-radius:15px; overflow:hidden; text-decoration:none;
            box-shadow:0 10px 20px rgba(0,0,0,0.7); transition:transform 0.4s, box-shadow 0.4s;
            border:1px solid var(--gold-dark); display:block;
        }
        .service-box:hover {
            transform:translateY(-10px) scale(1.02); box-shadow:0 20px 30px rgba(212,175,55,0.3);
            border-color:var(--gold-shine);
        }
        .service-box img {
            width:100%; height:100%; object-fit:cover; filter:brightness(50%);
            transition:filter 0.4s, transform 0.4s;
        }
        .service-box:hover img {
            filter:brightness(70%); transform:scale(1.05);
        }
        .service-box span {
            position:absolute; bottom:0; left:0; right:0; color:white; font-weight:bold; font-size:1.2rem;
            text-shadow:2px 2px 8px black; background:linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            padding:20px 5px 10px; text-align:center;
        }

        @media (max-width:768px) {
            .dr-title { font-size:1.8rem; }
            .card.expanded { width:95%; height:80vh; }
            .whatsapp-float { width:50px; height:50px; font-size:25px; bottom:10px; right:10px; }
            .services-grid { grid-template-columns:repeat(2,1fr); }
            .service-box { height:200px; }
            .external-boxes-login { gap:5px; }
            .external-box-login { width:60px; height:60px; font-size:0.6rem; }
            .external-box-login .box-image { height:30px; }
        }
        
        /* ===== AI CARTOON STYLES ===== */
        .ai-assistant {
            background: linear-gradient(145deg, #667eea, #764ba2);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            color: white;
            position: relative;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .ai-avatar {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .cartoon {
            width: 80px;
            height: 80px;
            background: #ffd966;
            border-radius: 50%;
            position: relative;
            border: 4px solid white;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .eyes {
            display: flex;
            gap: 15px;
            justify-content: center;
            padding-top: 25px;
        }

        .eye {
            width: 15px;
            height: 15px;
            background: #333;
            border-radius: 50%;
            animation: blink 3s infinite;
        }

        @keyframes blink {
            0%, 90%, 100% { transform: scaleY(1); }
            95% { transform: scaleY(0.1); }
        }

        .mouth {
            width: 30px;
            height: 15px;
            background: transparent;
            border-bottom: 4px solid #333;
            border-radius: 0 0 30px 30px;
            margin: 5px auto 0;
        }

        .doctor-hat {
            width: 40px;
            height: 20px;
            background: white;
            position: absolute;
            top: -10px;
            left: 20px;
            border-radius: 10px 10px 0 0;
        }

        .doctor-hat::before {
            content: "+";
            position: absolute;
            top: -15px;
            left: 15px;
            color: red;
            font-size: 20px;
            font-weight: bold;
        }

        .speech-bubble {
            background: white;
            color: #000000;
            padding: 15px 20px;
            border-radius: 25px 25px 25px 5px;
            position: relative;
            flex: 1;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            animation: glow 2s infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 5px 15px rgba(255,255,255,0.3); }
            50% { box-shadow: 0 5px 25px rgba(255,255,255,0.7); }
        }

        .speech-bubble::before {
            content: '';
            position: absolute;
            left: -15px;
            bottom: 10px;
            width: 0;
            height: 0;
            border: 15px solid transparent;
            border-right-color: white;
            border-left: 0;
            border-bottom: 0;
            transform: rotate(45deg);
        }

        .typing {
            color: #000000;
            font-size: 14px;
            margin-top: 5px;
        }

        .typing-dots::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
            width: 0;
            display: inline-block;
        }

        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }

        .step-guide {
            background: #a2e720;
            border-radius: 15px;
            padding: 15px;
            margin: 20px 0;
            border-left: 5px solid #252e55;
        }

        .step-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 8px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .step-item.active {
            background: #292f33;
            transform: scale(1.02);
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

        .step-number {
            width: 25px;
            height: 25px;
            background: #667eea;
            color: rgb(7, 6, 6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #725c5c;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        /* ===== WELCOME BANNER / LOADING SCREEN ===== */
        .welcome-banner {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            z-index: 20000;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeInBanner 0.8s ease;
        }
        
        @keyframes fadeInBanner {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .banner-content {
            max-width: 500px;
            width: 90%;
            background: rgba(20, 20, 20, 0.95);
            border: 2px solid var(--gold-primary);
            border-radius: 30px;
            padding: 40px 30px;
            text-align: center;
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.3);
            position: relative;
            overflow: hidden;
            animation: slideUpBanner 0.6s ease;
        }
        
        @keyframes slideUpBanner {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .banner-content::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold-shine), transparent);
            animation: scanBanner 2s linear infinite;
        }
        
        @keyframes scanBanner {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .banner-loader {
            margin-bottom: 30px;
        }
        
        .banner-spinner {
            width: 80px;
            height: 80px;
            margin: 0 auto;
            border: 4px solid rgba(212, 175, 55, 0.3);
            border-top: 4px solid var(--gold-shine);
            border-right: 4px solid var(--gold-shine);
            border-radius: 50%;
            animation: spinBanner 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
        }
        
        @keyframes spinBanner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .banner-title {
            color: var(--gold-shine);
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(212, 175, 55, 0.5);
            animation: glowText 2s infinite;
        }
        
        @keyframes glowText {
            0%, 100% { text-shadow: 0 0 15px rgba(212, 175, 55, 0.5); }
            50% { text-shadow: 0 0 30px rgba(212, 175, 55, 0.8); }
        }
        
        .banner-message {
            margin: 25px 0;
            min-height: 80px;
        }
        
        .banner-message p {
            color: #fff;
            font-size: 1.2rem;
            margin: 10px 0;
            opacity: 0;
            animation: fadeInMessage 0.5s forwards;
        }
        
        .banner-message p:first-child {
            animation-delay: 0.3s;
        }
        
        .typing-text {
            color: var(--gold-primary) !important;
            font-size: 1rem !important;
            position: relative;
            display: inline-block;
        }
        
        .typing-text::after {
            content: '|';
            position: absolute;
            right: -10px;
            animation: blink 0.7s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        
        @keyframes fadeInMessage {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .banner-progress {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 30px 0 20px;
            overflow: hidden;
        }
        
        .banner-progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--gold-dark), var(--gold-shine));
            border-radius: 10px;
            animation: progressLoad 2.5s ease-in-out forwards;
            box-shadow: 0 0 10px var(--gold-shine);
        }
        
        @keyframes progressLoad {
            0% { width: 0%; }
            20% { width: 30%; }
            40% { width: 50%; }
            60% { width: 65%; }
            80% { width: 85%; }
            100% { width: 100%; }
        }
        
        .banner-footer {
            margin-top: 25px;
        }
        
        .banner-update {
            color: var(--gold-primary);
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 10px;
            animation: pulseUpdate 2s infinite;
        }
        
        @keyframes pulseUpdate {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); color: var(--gold-shine); }
        }
        
        .banner-features {
            color: #aaa;
            font-size: 0.9rem;
            line-height: 1.6;
            margin: 15px 0;
            padding: 0 10px;
            border-left: 3px solid var(--gold-dark);
            border-right: 3px solid var(--gold-dark);
        }
        
        .banner-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
        }
        
        .dot {
            width: 8px;
            height: 8px;
            background: var(--gold-dark);
            border-radius: 50%;
            animation: dotPulse 1.5s infinite;
        }
        
        .dot:nth-child(2) {
            animation-delay: 0.3s;
        }
        
        .dot:nth-child(3) {
            animation-delay: 0.6s;
        }
        
        @keyframes dotPulse {
            0%, 100% { transform: scale(1); background: var(--gold-dark); }
            50% { transform: scale(1.3); background: var(--gold-shine); }
        }
        
        @media (max-width: 768px) {
            .banner-content {
                padding: 30px 20px;
            }
            .banner-title {
                font-size: 1.5rem;
            }
            .banner-message p {
                font-size: 1rem;
            }
            .banner-features {
                font-size: 0.8rem;
            }
        }
        
        @keyframes fadeOutBanner {
            from { opacity: 1; }
            to { opacity: 0; visibility: hidden; }
        }
    </style>
</head>
<body>

    <!-- KITUFE CHA KUSAKINISHA -->
    <div class="install-container">
        <button id="install-button">
            <i class="fas fa-download"></i> <i class="fas fa-star"></i>
        </button>
    </div>

    <!-- CODE OVERLAY (MFUMO WA MALIPO) -->
    <div id="code-overlay">
        <div class="code-box">
            <h2><i class="fas fa-lock"></i> KILINGE CHA DR WILLIAM KIMEFUNGWA</h2>
            <p>
                <strong style="color: #D4AF37; font-size: 1.1rem;">ðŸ’Ž BEI ZA CODE:</strong><br><br>
                <span style="color: #D4AF37;">âœ“ W001 = Tsh 5,000</span> - Siku 1<br>
                <span style="color: #D4AF37;">âœ“ W002 = Tsh 5,000</span> - Mwezi 1<br>
                <span style="color: #FFD700; font-weight: bold;">âœ“ W003 = Tsh 5,000</span> - Mwaka 1 (Milele - HUTALIPIA TENA!)<br><br>
                <strong>JINSI YA KUPATA:</strong><br>
                Tuma Tsh.5,000 kwenda M-Pesa <strong>0762286282</strong> (BARAKA RICHARD) kisha ubofye kitufe hapa chini kuomba code.
            </p>
            <input type="text" id="access-code" class="code-input" placeholder="INGIZA CODE HAPA" maxlength="4" autocomplete="off">
            <button class="btn-code" onclick="verifyCode()">FUNGUA KILINGE</button>
            <div class="error-message" id="code-error"></div>
            <button class="whatsapp-code-btn" onclick="requestCodeViaWhatsApp()">
                <i class="fab fa-whatsapp"></i> KUOMBA CODE WHATSAPP
            </button>

            <!-- VIBOX 4 vya nje kwenye login page -->
            <div class="external-boxes-login">
                <div class="external-box-login">
                    <div class="box-image" style="background-image: url('https://images.unsplash.com/photo-1611162617213-7d7a39e9b1d7?w=200&auto=format')"></div>
                    <div class="box-title">DW1</div>
                </div>
                <div class="external-box-login">
                    <div class="box-image" style="background-image: url('https://images.unsplash.com/photo-1611162618071-b39a2ec055fb?w=200&auto=format')"></div>
                    <div class="box-title">DW2</div>
                </div>
                <div class="external-box-login">
                    <div class="box-image" style="background-image: url('https://images.unsplash.com/photo-1611162617263-4ec3060a058e?w=200&auto=format')"></div>
                    <div class="box-title">DW3</div>
                </div>
                <div class="external-box-login">
                    <div class="box-image" style="background-image: url('https://images.unsplash.com/photo-1611162616550-7f3d2d642c1c?w=200&auto=format')"></div>
                    <div class="box-title">DW4</div>
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main-content">
        <div id="intro-overlay">
            <div class="mystic-circle"></div>
            <div class="intro-text" id="intro-text-content">KILINGE KINAFUNGUKA...</div>
        </div>

        <header>
            <h1 class="dr-title">DR. WILLIAM</h1>
            <p class="subtitle">Kilinge cha Tiba na Ramli za Kweli</p>
        </header>

        <div class="service-menu">
            <button class="btn-service active" onclick="switchPage('ramli', this)"><i class="fas fa-star"></i> Ramli</button>
            <button class="btn-service" onclick="switchPage('appointment', this)"><i class="fas fa-calendar-check"></i> Miadi</button>
            <button class="btn-service" onclick="switchPage('dawa', this)"><i class="fas fa-flask"></i> Dawa</button>
            <button class="btn-service" onclick="switchPage('malalamiko', this)"><i class="fas fa-comment-dots"></i> Maoni</button>
        </div>

        <!-- PAGE: RAMLI -->
        <div id="page-ramli" class="container">
            <h2><i class="fas fa-sun"></i> UFUNGUO WA NYOTA YAKO</h2>
            <label>Jina lako Kamili:</label> 
            <input type="text" id="full-name" placeholder="Mfano: JUMA HASSAN">
            <label>Jinsia:</label>
            <select id="gender">
                <option value="Mwanaume">Mwanaume</option>
                <option value="Mwanamke">Mwanamke</option>
            </select>
            <label>Tarehe ya Kuzaliwa:</label>
            <div style="display:flex; gap:10px;">
                <select id="birth-day">
                    <script>
                        for(let i=1;i<=31;i++) {
                            document.write(`<option value="${i}">${i}</option>`);
                        }
                    </script>
                </select>
                <select id="birth-month">
                    <option value="1">Januari</option>
                    <option value="2">Februari</option>
                    <option value="3">Machi</option>
                    <option value="4">Aprili</option>
                    <option value="5">Mei</option>
                    <option value="6">Juni</option>
                    <option value="7">Julai</option>
                    <option value="8">Agosti</option>
                    <option value="9">Septemba</option>
                    <option value="10">Oktoba</option>
                    <option value="11">Novemba</option>
                    <option value="12">Desemba</option>
                </select>
            </div>
            <button class="btn-magic" onclick="anzaRamli()">PANUA NYOTA YAKO</button>
        </div>

        <!-- PAGE: MIADI -->
        <div id="page-appointment" class="container" style="display:none;">
            
            <!-- AI CARTOON ASSISTANT -->
            <div class="ai-assistant" id="aiAssistant">
                <div class="ai-avatar">
                    <div class="cartoon">
                        <div class="doctor-hat"></div>
                        <div class="eyes">
                            <div class="eye"></div>
                            <div class="eye"></div>
                        </div>
                        <div class="mouth"></div>
                    </div>
                    <div class="speech-bubble" id="speechBubble">
                        <span id="aiMessage">ðŸ‘‹ Habari! Mimi ni Daktari Cartoon. Ngoja nikusaidie kuweka miadi kwa hatua 5 rahisi!</span>
                        <div class="typing">
                            <span class="typing-dots"></span> Ninaandaa maelekezo...
                        </div>
                    </div>
                </div>
                
                <!-- Mwongozo wa hatua -->
                <div class="step-guide" id="stepGuide">
                    <div class="step-item" data-step="1">
                        <span class="step-number">1</span>
                        <span>Andika jina lako kamili</span>
                    </div>
                    <div class="step-item" data-step="2">
                        <span class="step-number">2</span>
                        <span>Chagua tarehe unayotaka kuja</span>
                    </div>
                    <div class="step-item" data-step="3">
                        <span class="step-number">3</span>
                        <span>Elezea shida yako kwa ufupi</span>
                    </div>
                    <div class="step-item" data-step="4">
                        <span class="step-number">4</span>
                        <span>Weka namba yako ya simu</span>
                    </div>
                    <div class="step-item" data-step="5">
                        <span class="step-number">5</span>
                        <span>Bonyeza Tuma Miadi</span>
                    </div>
                </div>
                
                <!-- Progress bar -->
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                </div>
            </div>

            <h2><i class="fas fa-handshake"></i> PANGA SIKU YA KUFIKA</h2>
            <label>Jina:</label> 
            <input type="text" id="app-name">
            <label>Tarehe:</label> 
            <input type="date" id="app-date">
            <label>Sababu:</label> 
            <textarea id="app-reason" placeholder="Elezea shida yako..." rows="3"></textarea>
            <label>Simu:</label>
            <div style="display:flex; gap:10px;">
                <select style="width:30%">
                    <option>+255</option>
                    <option>+254</option>
                </select>
                <input type="text" id="app-phone" placeholder="762xxxxxx" maxlength="9">
            </div>
            <button class="btn-magic" onclick="tumaWhatsApp('MIADI')">TUMA MIADI</button>
        </div>

        <!-- PAGE: DAWA -->
        <div id="page-dawa" class="container" style="display:none;">
            <h2><i class="fas fa-leaf"></i> ODA DAWA ASILIA</h2>
            <label>Chagua Dawa:</label>
            <select name="dawa_list" id="dawa_list">
                <option value="">-- Chagua Aina ya Dawa --</option>
                <option value="Dawa za minyoo">Dawa za minyoo</option>
                <option value="Dawa za maumivu na homa">Dawa za maumivu na homa</option>
                <option value="Dawa za antibiotiki">Dawa za antibiotiki</option>
                <option value="Dawa za malaria">Dawa za malaria</option>
                <option value="Dawa za fangasi">Dawa za fangasi</option>
                <option value="Dawa za virusi">Dawa za virusi</option>
                <option value="Dawa za kusafisha vidonda">Dawa za kusafisha vidonda</option>
                <option value="Dawa za vidonda vya tumbo">Dawa za vidonda vya tumbo</option>
                <option value="Dawa za kuhara">Dawa za kuhara</option>
                <option value="Dawa za kupunguza asidi">Dawa za kupunguza asidi mwilini</option>
                <option value="Dawa za kulainisha choo">Dawa za kulainisha choo</option>
                <option value="Dawa za kuzuia kutapika">Dawa za kuzuia kutapika</option>
                <option value="Dawa za bawasiri">Dawa za bawasiri</option>
                <option value="Dawa za gesi tumboni">Dawa za gesi tumboni</option>
                <option value="Dawa za kuongeza hamu ya kula">Dawa za kuongeza hamu ya kula</option>
                <option value="Dawa za kikohozi na mafua">Dawa za kikohozi na mafua</option>
                <option value="Dawa za mzio na aleji">Dawa za mzio na aleji</option>
                <option value="Dawa za pumu">Dawa za pumu</option>
                <option value="Dawa za kuzibua pua">Dawa za kuzibua pua</option>
                <option value="Dawa za kulegeza makohozi">Dawa za kulegeza makohozi</option>
                <option value="Dawa za shinikizo la damu">Dawa za shinikizo la damu</option>
                <option value="Dawa za kisukari">Dawa za kisukari</option>
                <option value="Dawa za kupunguza mafuta">Dawa za kupunguza mafuta/kolesto</option>
                <option value="Dawa za kifafa">Dawa za kifafa</option>
                <option value="Dawa za moyo">Dawa za moyo</option>
                <option value="Dawa za kusaidia figo">Dawa za kusaidia figo</option>
                <option value="Dawa za kansa">Dawa za kansa</option>
                <option value="Dawa za uzazi wa mpango">Dawa za uzazi wa mpango</option>
                <option value="Dawa za fangasi wa kike">Dawa za fangasi wa kike</option>
                <option value="Dawa za kurekebisha homoni">Dawa za kurekebisha homoni</option>
                <option value="Dawa za kuongeza rutuba">Dawa za kuongeza rutuba</option>
                <option value="Dawa za maumivu ya hedhi">Dawa za maumivu ya hedhi</option>
                <option value="Dawa za matatizo ya macho">Dawa za matatizo ya macho</option>
                <option value="Dawa za masikio">Dawa za masikio</option>
                <option value="Dawa za matatizo ya ngozi">Dawa za matatizo ya ngozi</option>
                <option value="Dawa za maumivu ya mifupa">Dawa za maumivu ya mifupa na viungo</option>
                <option value="Dawa za meno na fizi">Dawa za meno na fizi</option>
                <option value="Dawa za ganzi">Dawa za ganzi</option>
                <option value="Dawa za kuongeza damu">Dawa za kuongeza damu</option>
                <option value="Dawa za vitamini">Dawa za vitamini na virutubisho</option>
                <option value="Dawa za kuongeza kinga">Dawa za kuongeza kinga ya mwili</option>
                <option value="Dawa za kalsiamu">Dawa za kalsiamu na mifupa</option>
                <option value="Mafuta ya samaki">Mafuta ya samaki</option>
                <option value="Dawa za usingizi">Dawa za usingizi na wasiwasi</option>
                <option value="Dawa za sonona">Dawa za sonona</option>
                <option value="Dawa za kuacha kulevya">Dawa za kuacha kulevya</option>
                <option value="Dawa za kupunguza uzito">Dawa za kupunguza uzito</option>
                <option value="Dawa za kutoa sumu mwilini">Dawa za kutoa sumu mwilini</option>
                <option value="Dawa za baridi yabisi">Dawa za baridi yabisi</option>
                <option value="Dawa za kuongeza nguvu">Dawa za maji ya kuongeza nguvu</option>
            </select>
            <label>Mahali (Mkoa/Wilaya):</label> 
            <input type="text" id="dawa-location">
            <label>Simu:</label> 
            <input type="text" id="dawa-phone" placeholder="762xxxxxx">
            <button class="btn-magic" onclick="tumaWhatsApp('DAWA')">TUMA ODA SASA</button>
        </div>

        <!-- PAGE: MALALAMIKO -->
        <div id="page-malalamiko" class="container" style="display:none;">
            <h2><i class="fas fa-envelope-open-text"></i> ELEZEA MALALAMIKO YAKO</h2>
            <textarea id="msg-content" rows="5" placeholder="Tuandikie hapa..."></textarea>
            <button class="btn-magic" onclick="tumaWhatsApp('MAONI')">TUMA UJUMBE</button>
        </div>

        <!-- CARDS CONTAINER -->
        <div id="cards-container"></div>

        <!-- SEND RESULTS -->
        <div id="send-results-container" class="container" style="display:none; text-align:center;">
            <button class="send-btn" onclick="tumaMatokeoWhatsApp()">
                <i class="fab fa-whatsapp"></i> MSHIRIKISHE DAKTARI MAJIBU YAKO
            </button>
        </div>

        <!-- NEXT PAGE -->
        <div id="next-page-container" class="container" style="display:none; text-align:center; border-color: #ff4444;">
            <h2 style="color: #ff4444;"><i class="fas fa-door-open"></i> MUENDELEZO</h2>
            <p style="color: #ccc;">Kuna siri zaidi kuhusu nyota yako...</p>
            <a href="https://biotech-america-reseach.github.io/orcle/" class="btn-next-page">
                KUJUA KADI ZAKO 3 <i class="fas fa-arrow-right"></i>
            </a>
        </div>

        <!-- HUDUMA -->
        <div class="services-container">
            <h2 class="section-title">KILINGE CHA KICHAWI</h2>
            <div class="services-grid">
                <a href="https://wasiliananadrktari.netlify.app/" class="service-box">
                    <img src="https://images.unsplash.com/photo-1596526131083-e8c633c948d2?q=80&w=400&auto=format&fit=crop" alt="Ongea na Dr William">
                    <span>ONGEA NA DR WILLIAM HAPA</span>
                </a>
                <a href="https://vitabu.vercel.app/" class="service-box">
                    <img src="https://images.unsplash.com/photo-1495446815901-a7297e633e8d?q=80&w=400&fit=crop" alt="Duka la Vitabu">
                    <span>DUKA LA VITABU</span>
                </a>
                <a href="#" class="service-box">
                    <img src="https://images.unsplash.com/photo-1502444330042-d1a1ddf9bb5b?q=80&w=400&fit=crop" alt="Huduma 3">
                    <span>Ushauri wa Kiroho</span>
                </a>
                <a href="#" class="service-box">
                    <img src="https://images.unsplash.com/photo-1506126613408-eca07ce68773?q=80&w=400&fit=crop" alt="Huduma 4">
                    <span>Visomo Maalum</span>
                </a>
                <a href="#" class="service-box">
                    <img src="https://images.unsplash.com/photo-1515598344952-097560877960?q=80&w=400&fit=crop" alt="Huduma 5">
                    <span>Mafuta ya Baraka</span>
                </a>
                <a href="#" class="service-box">
                    <img src="https://images.unsplash.com/photo-1532187875605-2fe358511423?q=80&w=400&fit=crop" alt="Huduma 6">
                    <span>Vitabu Zaidi</span>
                </a>
            </div>
        </div>

        <!-- WHATSAPP FLOAT -->
        <div class="whatsapp-float" onclick="window.open('https://wa.me/255762286282', '_blank')">
            <i class="fab fa-whatsapp"></i>
        </div>
    </div>

    <!-- SERVICE WORKER -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js').catch(err => console.log('SW failed', err));
            });
        }
    </script>

    <!-- INSTALL SCRIPT -->
    <script>
        const installBtn = document.getElementById('install-button');
        const installContainer = document.querySelector('.install-container');
        let deferredPrompt = null;
        let userEntered = false;

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
        });

        if (installBtn) {
            installBtn.addEventListener('click', () => {
                const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
                if (isIOS) {
                    alert('Kwa iPhone: Bofya ikoni ya "Share" chini, kisha chagua "Add to Home Screen".');
                } else if (deferredPrompt) {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            installBtn.innerHTML = '<i class="fas fa-check"></i>';
                        }
                        deferredPrompt = null;
                    });
                } else {
                    alert('Ili kusakinisha, tumia Chrome au Safari kwenye simu. Au tafuta chaguo la "Install app" kwenye menyu.');
                }
                
                hideInstallButton();
            });
        }

        window.addEventListener('appinstalled', () => {
            if (installBtn) {
                installBtn.innerHTML = '<i class="fas fa-check"></i>';
            }
            hideInstallButton();
        });

        const mainContent = document.getElementById('main-content');
        if (mainContent) {
            mainContent.addEventListener('click', function() {
                if (!userEntered) {
                    userEntered = true;
                    hideInstallButton();
                }
            });
        }

        window.addEventListener('scroll', function() {
            if (!userEntered && window.scrollY > 100) {
                userEntered = true;
                hideInstallButton();
            }
        });

        const codeInput = document.getElementById('access-code');
        if (codeInput) {
            codeInput.addEventListener('input', function() {
                if (this.value.length >= 3 && !userEntered) {
                    userEntered = true;
                    hideInstallButton();
                }
            });
        }

        function hideInstallButton() {
            if (installContainer) {
                installContainer.style.animation = 'fadeOut 1s forwards';
                setTimeout(() => {
                    installContainer.style.display = 'none';
                }, 1000);
            }
        }

        setTimeout(() => {
            if (!userEntered) {
                hideInstallButton();
            }
        }, 10000);
    </script>

    <!-- PARALLAX -->
    <script>
        window.addEventListener('scroll', () => {
            document.body.style.backgroundPosition = `center ${window.pageYOffset * 0.3}px`;
        });
    </script>

    <!-- MAIN SCRIPT (ZODIAC DATA + FUNCTIONS) -->
    <script>
        // ==================== FUNCTIONS ZA MSINGI ====================
        function sanitizeHTML(str) {
            if (!str) return '';
            return String(str)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }

        function sanitizeArray(arr) {
            return arr.map(item => sanitizeHTML(item));
        }

        // ==================== MFUMO WA MALIPO (W001, W002, W003) ====================
        // Hii inahifadhi muda wa kutumia kwa kutumia localStorage
        function verifyCode() {
            const codeInput = document.getElementById('access-code');
            const errorDiv = document.getElementById('code-error');
            if (!codeInput || !errorDiv) return;
            
            const code = codeInput.value.trim().toUpperCase();
            
            // Codes zinazokubalika
            const validCodes = {
                'W001': { days: 1, name: 'Siku 1' },
                'W002': { days: 30, name: 'Mwezi 1' },
                'W003': { days: 365, name: 'Mwaka 1 (Milele - HUTALIPIA TENA)' }
            };
            
            if (validCodes[code]) {
                // Tunaangalia kama code ni sahihi
                const selectedPlan = validCodes[code];
                
                // Tunahesabu muda wa kuisha
                const now = new Date().getTime();
                const expiryTime = now + (selectedPlan.days * 24 * 60 * 60 * 1000);
                
                // Tunahifadhi kwenye browser ya mtumiaji
                localStorage.setItem('drWilliamAccess', 'true');
                localStorage.setItem('drWilliamExpiry', expiryTime.toString());
                localStorage.setItem('drWilliamPlan', selectedPlan.name);
                localStorage.setItem('drWilliamCode', code);
                
                // Tunaonyesha ujumbe wa kufanikiwa
                const codeOverlay = document.getElementById('code-overlay');
                const mainContent = document.getElementById('main-content');
                
                if (codeOverlay) codeOverlay.style.display = 'none';
                if (mainContent) mainContent.style.display = 'block';
                
                // Tunaonyesha taarifa ya muda uliobaki
                showRemainingTime();
                
                // Tunaanza kuhesabu muda
                startCountdown();
                
                // Tunaonyesha ujumbe wa kukaribisha
                setTimeout(() => {
                    alert(`âœ… Umeingiza code ya ${selectedPlan.name}!\n\nMuda wako utaisha: ${new Date(expiryTime).toLocaleString()}`);
                }, 500);
                
            } else {
                errorDiv.innerText = 'âŒ Code si sahihi. Tafadhali omba code sahihi kupitia WhatsApp.';
                codeInput.classList.add('shake');
                setTimeout(() => codeInput.classList.remove('shake'), 500);
            }
        }

        // Function ya kuonyesha muda uliobaki
        function showRemainingTime() {
            const expiry = localStorage.getItem('drWilliamExpiry');
            const plan = localStorage.getItem('drWilliamPlan');
            
            if (!expiry) return;
            
            const now = new Date().getTime();
            const timeLeft = parseInt(expiry) - now;
            
            if (timeLeft <= 0) {
                // Muda umeisha
                logoutUser("â° MUDA WAKO UMEISHA! Tafadhali changia Tsh 5,000 tena kupata code mpya ya kufungua tena.");
                return;
            }
            
            // Tunahesabu muda uliobaki
            const daysLeft = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
            const hoursLeft = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutesLeft = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            
            // Tunaunda kipengele cha kuonyesha muda kama hakipo
            let timerDiv = document.getElementById('timer-display');
            
            if (!timerDiv) {
                timerDiv = document.createElement('div');
                timerDiv.id = 'timer-display';
                document.body.appendChild(timerDiv);
            }
            
            let timeText = '';
            if (daysLeft > 0) {
                timeText = `${daysLeft} siku ${hoursLeft} saa`;
            } else if (hoursLeft > 0) {
                timeText = `${hoursLeft} saa ${minutesLeft} dakika`;
            } else {
                timeText = `${minutesLeft} dakika`;
            }
            
            timerDiv.innerHTML = `â³ Muda umebaki: ${timeText} | ${plan}`;
        }

        // Function ya kuhesabu muda chini
        function startCountdown() {
            // Tunaangalia kila dakika 1
            setInterval(function() {
                const expiry = localStorage.getItem('drWilliamExpiry');
                if (!expiry) return;
                
                const now = new Date().getTime();
                const timeLeft = parseInt(expiry) - now;
                
                if (timeLeft <= 0) {
                    // Muda umeisha - tunafuta data na kuonyesha ujumbe
                    logoutUser("â° MUDA WAKO UMEISHA! Tafadhali changia Tsh 5,000 tena kupata code mpya.");
                } else {
                    showRemainingTime();
                }
            }, 60000); // Angalia kila dakika 1
        }

        // Function ya kumaliza muda na kuomba malipo
        function logoutUser(message) {
            // Tunaonyesha ujumbe
            alert(message);
            
            // Tunafuta data zote za kumbukumbu
            localStorage.removeItem('drWilliamAccess');
            localStorage.removeItem('drWilliamExpiry');
            localStorage.removeItem('drWilliamPlan');
            localStorage.removeItem('drWilliamCode');
            
            // Tunaondoa timer
            const timerDiv = document.getElementById('timer-display');
            if (timerDiv) timerDiv.remove();
            
            // Tunaficha main content
            document.getElementById('main-content').style.display = 'none';
            
            // Tunaonyesha code overlay tena
            const codeOverlay = document.getElementById('code-overlay');
            codeOverlay.style.display = 'flex';
            
            // Tunaweka ujumbe maalum
            document.querySelector('.code-box p').innerHTML = `
                <strong style="color: #ff6b6b;">â° MUDA WAKO UMEISHA!</strong><br><br>
                <strong style="color: #D4AF37;">ðŸ’Ž BEI ZA CODE:</strong><br><br>
                <span style="color: #D4AF37;">âœ“ W001 = Tsh 5,000</span> - Siku 1<br>
                <span style="color: #D4AF37;">âœ“ W002 = Tsh 5,000</span> - Mwezi 1<br>
                <span style="color: #FFD700; font-weight: bold;">âœ“ W003 = Tsh 5,000</span> - Mwaka 1 (Milele - HUTALIPIA TENA!)<br><br>
                <strong>JINSI YA KUPATA:</strong><br>
                Tuma Tsh.5,000 tena kwenda M-Pesa <strong>0762286282</strong> (BARAKA RICHARD) upate code mpya.
            `;
        }

        // Function ya kuonyesha ujumbe wa kuongeza muda
        function showExpiryMessage() {
            const expiry = localStorage.getItem('drWilliamExpiry');
            const plan = localStorage.getItem('drWilliamPlan');
            
            if (!expiry) return;
            
            const now = new Date().getTime();
            const timeLeft = parseInt(expiry) - now;
            const daysLeft = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
            const hoursLeft = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutesLeft = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            
            let message = `â° MUDA WAKO ULIOSALIA:\n\n`;
            
            if (daysLeft > 0) {
                message += `${daysLeft} siku, ${hoursLeft} saa, na ${minutesLeft} dakika\n\n`;
            } else if (hoursLeft > 0) {
                message += `${hoursLeft} saa na ${minutesLeft} dakika\n\n`;
            } else {
                message += `${minutesLeft} dakika\n\n`;
            }
            
            message += `Ulipochagua mpango wa: ${plan}\n\n`;
            message += `ðŸ’¡ UKITAKA KUONGEZA MUDA:\n`;
            message += `Tuma Tsh 5,000 M-Pesa 0762286282 (BARAKA RICHARD)`;
            message += `\n\nW001 = Siku 1\nW002 = Mwezi 1\nW003 = Mwaka 1 (milele)`;
            
            alert(message);
        }

        // Function ya kuangalia kama mtumiaji ana access kabla ya kupakia ukurasa
        function checkAccessOnLoad() {
            const access = localStorage.getItem('drWilliamAccess');
            const expiry = localStorage.getItem('drWilliamExpiry');
            
            if (access === 'true' && expiry) {
                const now = new Date().getTime();
                const timeLeft = parseInt(expiry) - now;
                
                if (timeLeft > 0) {
                    // Muda bado upo - funga code overlay
                    document.getElementById('code-overlay').style.display = 'none';
                    document.getElementById('main-content').style.display = 'block';
                    showRemainingTime();
                    startCountdown();
                } else {
                    // Muda umeisha
                    localStorage.removeItem('drWilliamAccess');
                    localStorage.removeItem('drWilliamExpiry');
                    localStorage.removeItem('drWilliamPlan');
                    localStorage.removeItem('drWilliamCode');
                }
            }
        }

        // Function ya kuomba code kupitia WhatsApp
        function requestCodeViaWhatsApp() {
            const message = `Halo Dr. William, ninaomba code ya kufungua Kilinge chako. Nimetuma Tsh 5,000 M-Pesa. Nataka code ya: W003 (milele). Jina langu: [ANDIKA JINA LAKO HAPA]`;
            window.open(`https://wa.me/255762286282?text=${encodeURIComponent(message)}`, '_blank');
        }

        // ==================== DATA ZA ZODIAC (1-12) ====================
        const ZODIAC_DB = {
            1: { 
                name: "Wewe ni Kondoo (Aries)", 
                image: "https://images.unsplash.com/photo-1533036696707-887498c25389?auto=format&fit=crop&w=600&q=80",
                good: [
                    "ðŸŒ‹ Mjasiri: Hauogopi kukabiliana na changamoto zozote",
                    "âš¡ Mwenye ujasiri: Una moyo wa simba",
                    "ðŸ‘‘ Mwenye uongozi: Watu wanakufuata kwa hiari",
                    "ðŸ”¥ Mwenye shauku: Kila unachokifanya unakifanya kwa hamasa",
                    "ðŸŽ¯ Mwenye uamuzi: Mara tu unapolenga kitu, hukati tamaa",
                    "ðŸ’ª Mwenye nguvu: Una nguvu za kutosha kuvumilia taabu",
                    "ðŸƒ Mwenye bidii: Wewe si mvivu, unapenda kufanya kazi",
                    "â›°ï¸ Mwenye malengo: Una ndoto kubwa na unafanya kila liwezekanalo",
                    "ðŸ‘ï¸ Mwenye maono: Una uwezo wa kuona mbali",
                    "ðŸ› ï¸ Mwenye ustadi: Una uwezo wa kufanya mambo kwa mikono yako",
                    "ðŸŽ¨ Mwenye uhodari: Kila unachogusa kinageuka kuwa kizuri",
                    "âœ¨ Mwenye uwezo: Una kipaji cha pekee cha kufanikisha mambo",
                    "ðŸ§˜ Mwenye nidhamu: Unajidhibiti na kufuata ratiba yako",
                    "â³ Mwenye subira: Unajua kusubiri pale inapobidi",
                    "ðŸ¤ Mwenye urafiki: Una uwezo wa kuvutia marafiki",
                    "ðŸ¤² Mwenye ushirikiano: Unajua kufanya kazi na wengine",
                    "â¤ï¸ Mwenye upendo: Unawapenda watu wako kwa dhati",
                    "ðŸ˜¢ Mwenye huruma: Una moyo wa kuwahurumia wanaoteseka",
                    "ðŸŽ© Mwenye heshima: Unawaheshimu wakubwa na wadogo",
                    "ðŸ‘‚ Mwenye uelewa: Unawaelewa watu na hali zao",
                    "ðŸ¤ Mwaminifu: Ukipewa siri, huitoi",
                    "ðŸŒµ Mstahimilivu: Unavumilia magumu na shida",
                    "ðŸ¤² Mwenye ukarimu: Unatoa kwa moyo wako",
                    "ðŸ§  Mwenye hekima: Una busara ya kutosha kuepuka mitego",
                    "ðŸŒŸ Mwenye kipaji: Una kipaji cha pekee",
                    "ðŸ’¡ Mwenye ubunifu: Unakuja na mawazo mapya",
                    "ðŸ” Mwenye uvumbuzi: Unapenda kutafuta mambo mapya",
                    "ðŸŒ² Mwenye msimamo: Hauyumbishwi na upepo",
                    "ðŸ•Šï¸ Mwenye amani: Unapenda amani na kuepuka ugomvi",
                    "ðŸŒŠ Mwenye utulivu: Hata nyakati za dhiki, unajua kudhibiti hisia zako"
                ],
                bad: [
                    "ðŸ’¢ Mwenye hasira: Hukasirika kwa urahisi na hasira zako huwa kali",
                    "âŒ› Mwenye kukosa subira: Unapotaka kitu, unakitaka sasa hivi",
                    "ðŸ˜Ÿ Mwenye wasiwasi: Mara nyingine una wasiwasi usio na msingi",
                    "ðŸ›¡ï¸ Mwenye kujitetea: Unapojiona unashambuliwa, hukawia kutetea",
                    "ðŸ’” Mwenye kukosa huruma: Wakati mwingine unashindwa kuwahurumia",
                    "ðŸš« Mwenye kukosa heshima: Hutaweza kuwaheshimu wengine unapokasirika",
                    "ðŸ™‰ Mwenye kukosa uelewa: Mara nyingine unashindwa kuelewa hisia",
                    "ðŸ¤¼ Mwenye kukosa ushirikiano: Unapotaka kufanya mambo yako mwenyewe",
                    "ðŸ¤¥ Mwenye kukosa uaminifu: Wakati mwingine unaweza kuvunja ahadi",
                    "ðŸ’” Mwenye kukosa upendo: Unapojikuta katika hali ngumu",
                    "â˜®ï¸ Mwenye kukosa amani: Unaweza kuleta mvutano usiohitajika",
                    "ðŸŒªï¸ Mwenye kukosa utulivu: Wakati mwingine huwa na kichaa kidogo",
                    "ðŸ§± Mwenye kukosa uvumilivu: Unachoka haraka na kukata tamaa",
                    "ðŸ¤² Mwenye kukosa ukarimu: Wakati mwingine unakuwa mgumu kutoa",
                    "ðŸ“š Mwenye kukosa hekima: Hufanya maamuzi ya kipumbavu",
                    "ðŸ§  Mwenye kukosa busara: Wakati mwingine hufanya mambo bila kufikiri",
                    "âš–ï¸ Mwenye kukosa nidhamu: Unaweza kujiachia na kufanya mambo ovyo",
                    "ðŸ§­ Mwenye kukosa mwelekeo: Hujui unakokwenda maishani",
                    "ðŸŽ¯ Mwenye kukosa malengo: Unaweza kuishi bila malengo",
                    "ðŸ‘“ Mwenye kukosa maono: Huna uwezo wa kuona umbali wa mbele",
                    "ðŸª« Mwenye kukosa uwezo: Kuna mambo unashindwa kabisa kuyafanya",
                    "ðŸ¦¾ Mwenye kukosa nguvu: Wakati mwingine unajisikia dhaifu",
                    "ðŸ”§ Mwenye kukosa uhodari: Huna ustadi wa kutosha",
                    "âœ‚ï¸ Mwenye kukosa ustadi: Unakosea na kuharibu vitu",
                    "ðŸ§‘â€ðŸ¤â€ðŸ§‘ Mwenye kukosa urafiki: Unaweza kuwafukuza marafiki",
                    "ðŸ’• Mwenye kukosa mapenzi: Unaweza kushindwa kupenda",
                    "ðŸ’’ Mwenye kukosa ndoa: Unaweza kuwa na shida za kudumu",
                    "ðŸ‘ª Mwenye kukosa familia: Unaweza kujitenga na familia",
                    "ðŸ˜ï¸ Mwenye kukosa jamii: Unaweza kujitenga na jamii",
                    "ðŸ’° Mwenye pupa: Unapenda mali na pesa kupita kiasi"
                ],
                health: [
                    "ðŸ¤• Maumivu ya kichwa (78%) - Kutokana na msongo wa mawazo na hasira",
                    "ðŸ’“ Shinikizo la damu (65%) - Kwa sababu ya kukasirika na kuharakisha mambo",
                    "ðŸ‘“ Matatizo ya macho (55%) - Kutokana na kukaa muda mrefu kwenye taa",
                    "ðŸ¦´ Maumivu ya mgongo (72%) - Kwa sababu ya kufanya kazi kwa bidii",
                    "ðŸª± Kichocho (45%) - Kwa sababu ya kukaa kwenye maji yasiyo safi",
                    "ðŸ¤§ Mafua (82%) - Kwa sababu ya kukosa kinga ya mwili",
                    "ðŸ˜¤ Kikohozi (68%) - Kutokana na kuvuta vumbi",
                    "ðŸ¦µ Maumivu ya viungo (58%) - Kwa sababu ya kufanya kazi nzito",
                    "ðŸ§´ Kichocheo cha ngozi (42%) - Kwa sababu ya mzio",
                    "ðŸ©¸ Upungufu wa damu (38%) - Kutokana na lishe duni",
                    "ðŸ¬ Kisukari (32%) - Kwa sababu ya kula vyakula vitamu",
                    "âš¡ Kifafa (12%) - Kwa sababu ya msongo wa mawazo",
                    "ðŸŒ¬ï¸ Pumu (28%) - Kwa sababu ya kuvuta vumbi",
                    "ðŸŒ¿ Mzio (48%) - Kwa sababu ya vumbi na vyakula",
                    "ðŸ¤¢ Kuumwa na tumbo (62%) - Kwa sababu ya kula vyakula vibaya",
                    "ðŸš½ Kuhara (52%) - Kwa sababu ya kula vyakula vilivyooza",
                    "ðŸ’© Kuvimbiwa (44%) - Kwa sababu ya kukosa kula nyuzinyuzi",
                    "ðŸ¤® Kichefuchefu (36%) - Kwa sababu ya mfadhaiko",
                    "ðŸ”„ Kutapika (24%) - Kwa sababu ya sumu ya chakula",
                    "ðŸŒ¡ï¸ Homba (18%) - Kwa sababu ya malaria"
                ],
                avoid: [
                    "ðŸº Pombe - Inaharibu ini na kukufanya uwe mjeuri zaidi",
                    "ðŸš¬ Sigara - Inaharibu mapafu na kukufanya ukose nguvu",
                    "ðŸ° Vyakula vitamu - Huongeza sukari na kukuza kisukari",
                    "ðŸ” Mafuta mengi - Huziba mishipa ya damu",
                    "ðŸ§‚ Chumvi nyingi - Huongeza shinikizo la damu",
                    "â˜€ï¸ Kukaa jua kali - Huleta kansa ya ngozi",
                    "ðŸŒ™ Kukaa usiku - Huharibu usingizi",
                    "ðŸ˜´ Kukosa usingizi - Hupunguza nguvu za mwili",
                    "ðŸ’§ Kukosa maji - Hukausha mwili na kuleta uchovu",
                    "ðŸ‹ï¸ Kukosa mazoezi - Hupunguza nguvu za mwili",
                    "ðŸ½ï¸ Kula kupita kiasi - Huleta unene na matatizo ya moyo",
                    "â˜• Kunywa kahawa nyingi - Huleta usingizi na kuongeza msongo",
                    "ðŸ¥« Vyakula vya makopo - Vina kemikali zinazoharibu mwili",
                    "ðŸ¥¤ Vinywaji baridi - Vina sukari nyingi na kemikali hatari",
                    "ðŸŸ Vyakula vya haraka - Vina mafuta mengi na chumvi nyingi",
                    "ðŸ›ï¸ Kukaa kitandani - Hupunguza nguvu na kuleta uvivu",
                    "ðŸš Kukosa chakula - Hupunguza nguvu na kuleta upungufu wa damu",
                    "ðŸ¥— Kukosa lishe bora - Hupunguza kinga ya mwili",
                    "ðŸ’Š Kukosa dawa - Huongeza hatari ya magonjwa",
                    "ðŸ§˜ Kukosa mapumziko - Huleta uchovu na msongo"
                ],
                compatible: [
                    "ðŸ¤ Watu waliozaliwa Januari (A)",
                    "ðŸ¤ Watu waliozaliwa Machi (C)",
                    "ðŸ¤ Watu waliozaliwa Mei (E)",
                    "ðŸ¤ Watu waliozaliwa Julai (G)",
                    "ðŸ¤ Watu waliozaliwa Septemba (I)",
                    "ðŸ¤ Watu waliozaliwa Novemba (K)",
                    "ðŸ¤ Watu wenye nyota ya Simba",
                    "ðŸ¤ Watu wenye nyota ya Mshale",
                    "ðŸ¤ Watu wenye nyota ya Mapacha",
                    "ðŸ¤ Watu wenye damu ya moto"
                ],
                careers: [
                    "ðŸ‘® Kamanda wa Jeshi",
                    "ðŸ›ï¸ Mwanasiasa",
                    "ðŸ’¼ Mjasiriamali",
                    "ðŸ† Kocha wa Michezo",
                    "ðŸ“Š Wakala wa Mauzo",
                    "ðŸ—ï¸ Mhandisi wa Ujenzi",
                    "ðŸ¥ Daktari wa Upasuaji",
                    "ðŸ”¥ Mpiganaji Moto",
                    "ðŸ›¡ï¸ Mlinzi wa Rais",
                    "ðŸš’ Mwokozi wa Dharura"
                ],
                avoid_careers: [
                    "ðŸ“Š Kamwe usifanye kazi za Mhasibu",
                    "ðŸ“‹ Kamwe usifanye kazi za Karani",
                    "ðŸ“š Kamwe usifanye kazi za Mtunza Maktaba",
                    "ðŸ’» Kamwe usifanye kazi za Data Entry",
                    "ðŸ“Ž Kamwe usifanye kazi za Msaidizi wa Ofisi",
                    "âš–ï¸ Kamwe usifanye kazi za Mkalimani wa Sheria",
                    "ðŸ“ž Kamwe usifanye kazi za Mtatuzi wa Malalamiko",
                    "ðŸ§® Kamwe usifanye kazi za Mchambuzi wa Takwimu",
                    "ðŸ”¬ Kamwe usifanye kazi za Mtafiti wa Maabara",
                    "âœ‚ï¸ Kamwe usifanye kazi za Mshonaji"
                ]
            },
            // ... [ZODIAC DATA ZINGINE ZOTE ZINAENDELEA HAPA - NIMEZIONDOA KWA UFUPI ILI KUPUNGUZA UREFU, LAKINI WEKA ZOTE ZILIZOKUWEPO] ...
        };

        // ==================== DATA ZA HERUFI ====================
        const HERUFI_DB = {
            'A': [ "Una sifa za uongozi", "Una uwezo wa kuongoza" /* ... na zingine */ ],
            'B': [ "Una sifa za unyenyekevu", "Una uwezo wa kutunza siri" /* ... */ ],
            // ... [DATA ZINGINE ZOTE ZINAENDELEA] ...
        };

        // ==================== VARIABLES ZA GLOBAL ====================
        let currentData = null;

        // ==================== FUNCTIONS ZA RAMLI NA MIADI ====================
        function switchPage(pageId, btn) {
            const containers = document.querySelectorAll('.container');
            const serviceBtns = document.querySelectorAll('.btn-service');
            const cardsContainer = document.getElementById('cards-container');
            const sendResults = document.getElementById('send-results-container');
            const nextPage = document.getElementById('next-page-container');
            
            containers.forEach(el => el.style.display = 'none');
            serviceBtns.forEach(b => b.classList.remove('active'));
            
            const targetPage = document.getElementById('page-' + pageId);
            if (targetPage) targetPage.style.display = 'block';
            if (btn) btn.classList.add('active');
            
            if (pageId !== 'ramli') {
                if (cardsContainer) cardsContainer.style.display = 'none';
                if (sendResults) sendResults.style.display = 'none';
                if (nextPage) nextPage.style.display = 'none';
            }
        }

        function anzaRamli() {
            const nameInput = document.getElementById('full-name');
            if (!nameInput) return;
            
            const name = nameInput.value.trim();
            if (name.length < 3) { 
                alert("Tafadhali andika jina kamili."); 
                return; 
            }
            
            const introOverlay = document.getElementById('intro-overlay');
            if (introOverlay) introOverlay.style.display = 'flex';
            
            setTimeout(() => finishIntro(name), 2000);
        }

        function finishIntro(name) {
            const introOverlay = document.getElementById('intro-overlay');
            if (introOverlay) introOverlay.style.display = 'none';
            
            chakataData(name);
            
            const pageRamli = document.getElementById('page-ramli');
            const cardsContainer = document.getElementById('cards-container');
            const sendResults = document.getElementById('send-results-container');
            const nextPage = document.getElementById('next-page-container');
            
            if (pageRamli) pageRamli.style.display = 'none';
            if (cardsContainer) cardsContainer.style.display = 'flex';
            if (sendResults) sendResults.style.display = 'block';
            if (nextPage) nextPage.style.display = 'block';
        }

        function chakataData(name) {
            const daySelect = document.getElementById('birth-day');
            const monthSelect = document.getElementById('birth-month');
            
            if (!daySelect || !monthSelect) return;
            
            const d = parseInt(daySelect.value);
            const m = parseInt(monthSelect.value);
            
            // Find zodiac index based on date
            let zIdx = 1;
            if ((m == 3 && d >= 21) || (m == 4 && d <= 19)) zIdx = 1;
            else if ((m == 4 && d >= 20) || (m == 5 && d <= 20)) zIdx = 2;
            else if ((m == 5 && d >= 21) || (m == 6 && d <= 20)) zIdx = 3;
            else if ((m == 6 && d >= 21) || (m == 7 && d <= 22)) zIdx = 4;
            else if ((m == 7 && d >= 23) || (m == 8 && d <= 22)) zIdx = 5;
            else if ((m == 8 && d >= 23) || (m == 9 && d <= 22)) zIdx = 6;
            else if ((m == 9 && d >= 23) || (m == 10 && d <= 22)) zIdx = 7;
            else if ((m == 10 && d >= 23) || (m == 11 && d <= 21)) zIdx = 8;
            else if ((m == 11 && d >= 22) || (m == 12 && d <= 21)) zIdx = 9;
            else if ((m == 12 && d >= 22) || (m == 1 && d <= 19)) zIdx = 10;
            else if ((m == 1 && d >= 20) || (m == 2 && d <= 18)) zIdx = 11;
            else zIdx = 12;

            const zodiac = ZODIAC_DB[zIdx] || ZODIAC_DB[1];
            const letter = name.charAt(0).toUpperCase();
            const letterTraits = HERUFI_DB[letter] || HERUFI_DB['A'] || [];

            currentData = { 
                name: sanitizeHTML(name), 
                zodiac: sanitizeHTML(zodiac.name), 
                date: `${d}/${m}` 
            };
            
            const container = document.getElementById('cards-container');
            if (!container) return;
            
            container.innerHTML = '';

            // CARD 1: Nyota + Sifa
            const card1 = document.createElement('div'); 
            card1.className = 'card';
            
            const goodTraitsHTML = (zodiac.good || []).map(t => `<span>${sanitizeHTML(t)}</span>`).join('');
            const badTraitsHTML = (zodiac.bad || []).map(t => `<span>${sanitizeHTML(t)}</span>`).join('');
            
            card1.innerHTML = `
                <div class="card-inner">
                    <div class="card-back" style="background-image: url('${sanitizeHTML(zodiac.image)}')">
                        <div class="card-back-content">
                            <div class="card-title-back">NYOTA YAKO</div>
                            <div class="card-hint">Gusa Kufungua</div>
                        </div>
                    </div>
                    <div class="card-front">
                        <img src="${sanitizeHTML(zodiac.image)}" class="card-header-img" alt="zodiac" loading="lazy">
                        <button class="close-card" onclick="event.stopPropagation(); closeCard(this)">Ã—</button>
                        <div class="card-body">
                            <h3>${sanitizeHTML(zodiac.name).toUpperCase()}</h3>
                            <p><strong>Wewe ${sanitizeHTML(name)}, ni mtu:</strong></p>
                            <div class="good-traits">${goodTraitsHTML}</div>
                            <p><strong>Lakini changamoto zako ni:</strong></p>
                            <div class="bad-traits">${badTraitsHTML}</div>
                        </div>
                    </div>
                </div>`;
            card1.onclick = function() { toggleCard(this); }; 
            container.appendChild(card1);

            // CARD 2: Afya
            const healthList = (zodiac.health || []).slice(0, 20);
            const avoidList = (zodiac.avoid || []).slice(0, 20);
            
            const card2 = document.createElement('div'); 
            card2.className = 'card';
            card2.innerHTML = `
                <div class="card-inner">
                    <div class="card-back" style="background-image: url('https://images.unsplash.com/photo-1505751172876-fa1923c5c528?auto=format&fit=crop&w=600')">
                        <div class="card-back-content">
                            <div class="card-title-back">AFYA YAKO</div>
                            <div class="card-hint">Gusa Kufungua</div>
                        </div>
                    </div>
                    <div class="card-front">
                        <img src="https://images.unsplash.com/photo-1505751172876-fa1923c5c528?auto=format&fit=crop&w=600" class="card-header-img" alt="health" loading="lazy">
                        <button class="close-card" onclick="event.stopPropagation(); closeCard(this)">Ã—</button>
                        <div class="card-body">
                            <h3>AFYA YAKO (${sanitizeHTML(zodiac.name)})</h3>
                            <p><strong>Uwezekano wa kupata:</strong></p>
                            <ul>${healthList.map(h => `<li>${sanitizeHTML(h)}</li>`).join('')}</ul>
                            <p><strong>Epuka vitu hivi:</strong></p>
                            <ul>${avoidList.map(a => `<li>${sanitizeHTML(a)}</li>`).join('')}</ul>
                        </div>
                    </div>
                </div>`;
            card2.onclick = function() { toggleCard(this); }; 
            container.appendChild(card2);

            // CARD 3: Herufi ya jina
            const traits = letterTraits.slice(0, 40);
            const compatible = (zodiac.compatible || []).slice(0, 10);
            
            const card3 = document.createElement('div'); 
            card3.className = 'card';
            card3.innerHTML = `
                <div class="card-inner">
                    <div class="card-back" style="background-image: url('https://images.unsplash.com/photo-1532153975070-2e9ab71f1b14?auto=format&fit=crop&w=600')">
                        <div class="card-back-content">
                            <div class="card-title-back">HERUFI YA JINA</div>
                            <div class="card-hint">Gusa Kufungua</div>
                        </div>
                    </div>
                    <div class="card-front">
                        <img src="https://images.unsplash.com/photo-1532153975070-2e9ab71f1b14?auto=format&fit=crop&w=600" class="card-header-img" alt="letter" loading="lazy">
                        <button class="close-card" onclick="event.stopPropagation(); closeCard(this)">Ã—</button>
                        <div class="card-body">
                            <h3>JINA LAKO (${sanitizeHTML(letter)})</h3>
                            <p><strong>Sifa zako za kipekee:</strong></p>
                            <ul>${traits.map(t => `<li>${sanitizeHTML(t)}</li>`).join('')}</ul>
                            <p><strong>Watu unaoweza kuendana nao:</strong></p>
                            <ul>${compatible.map(c => `<li>${sanitizeHTML(c)}</li>`).join('')}</ul>
                        </div>
                    </div>
                </div>`;
            card3.onclick = function() { toggleCard(this); }; 
            container.appendChild(card3);

            // CARD 4: Kazi
            const careers = (zodiac.careers || []).slice(0, 7);
            const avoidCareers = (zodiac.avoid_careers || []).slice(0, 7);
            
            const card4 = document.createElement('div'); 
            card4.className = 'card';
            card4.innerHTML = `
                <div class="card-inner">
                    <div class="card-back" style="background-image: url('https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?auto=format&fit=crop&w=600')">
                        <div class="card-back-content">
                            <div class="card-title-back">KAZI ZAKO</div>
                            <div class="card-hint">Gusa Kufungua</div>
                        </div>
                    </div>
                    <div class="card-front">
                        <img src="https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?auto=format&fit=crop&w=600" class="card-header-img" alt="career" loading="lazy">
                        <button class="close-card" onclick="event.stopPropagation(); closeCard(this)">Ã—</button>
                        <div class="card-body">
                            <h3>KAZI ZINAZOKUFA A (${sanitizeHTML(zodiac.name)})</h3>
                            <p><strong>Unastahili kufanya:</strong></p>
                            <ul>${careers.map(c => `<li>${sanitizeHTML(c)}</li>`).join('')}</ul>
                            <p><strong>Usifanye kazi hizi:</strong></p>
                            <ul>${avoidCareers.map(c => `<li>${sanitizeHTML(c)}</li>`).join('')}</ul>
                        </div>
                    </div>
                </div>`;
            card4.onclick = function() { toggleCard(this); }; 
            container.appendChild(card4);
        }

        function toggleCard(card) {
            if (!card) return;
            
            document.querySelectorAll('.card').forEach(c => { 
                if(c !== card) {
                    c.classList.remove('flipped', 'expanded');
                }
            });
            
            card.classList.toggle('flipped');
            
            if (card.classList.contains('flipped')) { 
                setTimeout(() => card.classList.add('expanded'), 400); 
            } else { 
                card.classList.remove('expanded'); 
            }
        }
        
        function closeCard(btn) {
            const card = btn.closest('.card');
            if (card) card.classList.remove('expanded', 'flipped');
        }
        
        function tumaWhatsApp(type) {
            let msg = "";
            
            if (type === 'MIADI') {
                const nameInput = document.getElementById('app-name');
                const dateInput = document.getElementById('app-date');
                const reasonInput = document.getElementById('app-reason');
                
                if (!nameInput || !dateInput || !reasonInput) return;
                
                const name = nameInput.value.trim();
                const date = dateInput.value;
                const reason = reasonInput.value.trim();
                
                if (!name || !date || !reason) {
                    alert("Tafadhali jaza taarifa zote");
                    return;
                }
                
                msg = `*MIADI YA DR. WILLIAM*%0A%0AJina: ${encodeURIComponent(name)}%0ATarehe: ${date}%0ASababu: ${encodeURIComponent(reason)}`;
            } else if (type === 'DAWA') {
                const dawaSelect = document.getElementById('dawa_list');
                const locInput = document.getElementById('dawa-location');
                const phoneInput = document.getElementById('dawa-phone');
                
                if (!dawaSelect || !locInput || !phoneInput) return;
                
                const dawa = dawaSelect.value;
                const loc = locInput.value.trim();
                const phone = phoneInput.value.trim();
                
                if (!dawa || !loc || !phone) {
                    alert("Tafadhali jaza taarifa zote");
                    return;
                }
                
                msg = `*ODA YA DAWA*%0A%0ADawa: ${encodeURIComponent(dawa)}%0AMahali: ${encodeURIComponent(loc)}%0ASimu: ${encodeURIComponent(phone)}`;
            } else if (type === 'MAONI') {
                const msgInput = document.getElementById('msg-content');
                if (!msgInput) return;
                
                const txt = msgInput.value.trim();
                if (!txt) {
                    alert("Tafadhali andika ujumbe");
                    return;
                }
                
                msg = `*MAONI*%0A%0A${encodeURIComponent(txt)}`;
            }
            
            window.open(`https://wa.me/255762286282?text=${msg}`, '_blank');
        }
        
        function tumaMatokeoWhatsApp() {
            if (!currentData) return;
            
            const msg = `*MATOKEO YA RAMLI (DR. WILLIAM)*%0A%0AJina: ${encodeURIComponent(currentData.name)}%0ANyota: ${encodeURIComponent(currentData.zodiac)}%0ATarehe: ${currentData.date}%0A%0ANimeona matokeo yangu, nahitaji ufafanuzi zaidi.`;
            window.open(`https://wa.me/255762286282?text=${msg}`, '_blank');
        }
        
        // ===== AI ASSISTANT KWA AJILI YA MIADI =====
        document.addEventListener('DOMContentLoaded', function() {
            const nameInput = document.getElementById('app-name');
            const dateInput = document.getElementById('app-date');
            const reasonInput = document.getElementById('app-reason');
            const phoneInput = document.getElementById('app-phone');
            const aiMessage = document.getElementById('aiMessage');
            const stepItems = document.querySelectorAll('.step-item');
            const progressFill = document.getElementById('progressFill');
            
            if (!nameInput || !aiMessage) return;
            
            const aiMessages = {
                1: "ðŸ“ Hatua ya 1: Tafadhali andika jina lako kamili. Hii itatusaidia kukutambua ukifika kliniki.",
                2: "ðŸ“… Hatua ya 2: Sasa chagua tarehe utakayofika. Unaweza kuchagua siku yoyote kuanzia kesho.",
                3: "ðŸ’¬ Hatua ya 3: Nieleze kwa ufupi shida yako. Hii itatusaidia kukutayarishia dawa sahihi.",
                4: "ðŸ“ž Hatua ya 4: Weka namba yako ya simu. Tutakutumia ukumbusho siku kabla ya miadi.",
                5: "âœ… Hatua ya Mwisho: Sasa bonyeza kitufe cha TUMA MIADI. Nakumbuka utapokea uthibitisho kwa WhatsApp!"
            };

            function speakToUser(step, message) {
                if (!aiMessage) return;
                aiMessage.innerText = message || aiMessages[step];
                
                stepItems.forEach(item => {
                    item.classList.remove('active');
                    if (item.dataset.step == step) {
                        item.classList.add('active');
                    }
                });
                
                const progress = (step / 5) * 100;
                if (progressFill) progressFill.style.width = progress + '%';
            }

            function checkStepProgress() {
                let completedSteps = 0;
                
                if (nameInput.value.trim().length > 3) {
                    completedSteps++;
                } else {
                    speakToUser(1);
                    return;
                }
                
                if (dateInput && dateInput.value) {
                    completedSteps++;
                } else {
                    speakToUser(2);
                    return;
                }
                
                if (reasonInput && reasonInput.value.trim().length > 5) {
                    completedSteps++;
                } else {
                    speakToUser(3);
                    return;
                }
                
                if (phoneInput && phoneInput.value.trim().length >= 9) {
                    completedSteps++;
                } else {
                    speakToUser(4);
                    return;
                }
                
                if (completedSteps === 4) {
                    speakToUser(5);
                }
            }

            nameInput.addEventListener('input', function() {
                if (this.value.length === 0) {
                    speakToUser(1);
                } else if (this.value.length > 3) {
                    setTimeout(() => {
                        if (dateInput && !dateInput.value) speakToUser(2);
                    }, 500);
                }
                checkStepProgress();
            });
            
            if (dateInput) {
                dateInput.addEventListener('change', function() {
                    if (this.value) {
                        setTimeout(() => {
                            if (reasonInput && !reasonInput.value.trim()) speakToUser(3);
                        }, 500);
                    }
                    checkStepProgress();
                });
            }
            
            if (reasonInput) {
                reasonInput.addEventListener('input', function() {
                    if (this.value.length > 5) {
                        setTimeout(() => {
                            if (phoneInput && !phoneInput.value.trim()) speakToUser(4);
                        }, 500);
                    }
                    checkStepProgress();
                });
            }
            
            if (phoneInput) {
                phoneInput.addEventListener('input', function() {
                    if (this.value.length >= 9) {
                        setTimeout(() => {
                            speakToUser(5);
                        }, 500);
                    }
                    checkStepProgress();
                });
            }
            
            setTimeout(() => {
                speakToUser(1);
            }, 1000);
            
            const today = new Date().toISOString().split('T')[0];
            if (dateInput) dateInput.min = today;
        });

        // ===== KUANZA KUANGALIA ACCESS UKURASA UKIPAKIA =====
        window.onload = function() {
            checkAccessOnLoad();
            
            // Ongeza event listener kwa ajili ya timer display kubofya
            document.body.addEventListener('click', function(e) {
                if (e.target.id === 'timer-display') {
                    showExpiryMessage();
                }
            });
        }
    </script>
</body>
</html>
